<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Snap Scroll Test</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html, body {
            scroll-snap-type: y mandatory;
            -webkit-overflow-scrolling: touch;
            overflow-x: hidden;
            overscroll-behavior: none;
        }
        
        .snap-section {
            height: 100vh;
            height: 100dvh;
            height: 100svh;
            scroll-snap-align: start;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            font-weight: bold;
            color: white;
            position: relative;
            transform: translateZ(0);
            -webkit-transform: translateZ(0);
        }
        
        .section-1 { background: linear-gradient(45deg, #ff6b6b, #ee5a24); }
        .section-2 { background: linear-gradient(45deg, #4834d4, #686de0); }
        .section-3 { background: linear-gradient(45deg, #00d2d3, #54a0ff); }
        .section-4 { background: linear-gradient(45deg, #ff9ff3, #f368e0); }
        .section-5 { background: linear-gradient(45deg, #feca57, #ff9ff3); }
        
        @media (max-width: 767px) {
            .snap-section {
                height: 100vh;
                height: 100dvh;
                height: 100svh;
                scroll-snap-align: start;
            }
            
            @supports (-webkit-touch-callout: none) {
                .snap-section {
                    -webkit-overflow-scrolling: touch;
                    min-height: 100vh;
                    min-height: 100dvh;
                    min-height: 100svh;
                }
            }
        }
    </style>
</head>
<body>
    <section class="snap-section section-1">
        <div>Section 1</div>
    </section>
    <section class="snap-section section-2">
        <div>Section 2</div>
    </section>
    <section class="snap-section section-3">
        <div>Section 3</div>
    </section>
    <section class="snap-section section-4">
        <div>Section 4</div>
    </section>
    <section class="snap-section section-5">
        <div>Section 5</div>
    </section>
    
    <script>
        // Улучшенная поддержка snap скролла для мобильных устройств
        function initMobileSnapScroll() {
            if (window.innerWidth <= 767) {
                // Отключаем smooth scroll для лучшего snap скролла на мобильных
                document.documentElement.style.scrollBehavior = 'auto';
                document.body.style.scrollBehavior = 'auto';
                
                // Добавляем обработчик для предотвращения bounce эффекта на iOS
                let startY = 0;
                let startScrollTop = 0;
                
                document.addEventListener('touchstart', function(e) {
                    startY = e.touches[0].clientY;
                    startScrollTop = window.pageYOffset || document.documentElement.scrollTop;
                }, { passive: true });
                
                document.addEventListener('touchmove', function(e) {
                    const currentY = e.touches[0].clientY;
                    const deltaY = currentY - startY;
                    
                    // Предотвращаем bounce эффект на iOS
                    if ((startScrollTop <= 0 && deltaY > 0) || 
                        (startScrollTop >= document.documentElement.scrollHeight - window.innerHeight && deltaY < 0)) {
                        e.preventDefault();
                    }
                }, { passive: false });
                
                // Улучшенная поддержка snap скролла
                let isScrolling = false;
                let scrollTimeout;
                
                window.addEventListener('scroll', function() {
                    if (!isScrolling) {
                        isScrolling = true;
                    }
                    
                    clearTimeout(scrollTimeout);
                    scrollTimeout = setTimeout(function() {
                        isScrolling = false;
                        
                        // Находим ближайшую секцию для snap
                        const sections = document.querySelectorAll('.snap-section');
                        const currentScroll = window.pageYOffset || document.documentElement.scrollTop;
                        const windowHeight = window.innerHeight;
                        
                        sections.forEach((section, index) => {
                            const sectionTop = section.offsetTop;
                            const sectionHeight = section.offsetHeight;
                            const sectionCenter = sectionTop + sectionHeight / 2;
                            
                            // Если секция находится в центре экрана, snap к ней
                            if (Math.abs(currentScroll + windowHeight / 2 - sectionCenter) < windowHeight / 3) {
                                setTimeout(() => {
                                    section.scrollIntoView({ 
                                        behavior: 'smooth',
                                        block: 'start'
                                    });
                                }, 100);
                            }
                        });
                    }, 150);
                });
            }
        }
        
        // Инициализация при загрузке
        document.addEventListener('DOMContentLoaded', function() {
            initMobileSnapScroll();
            
            // Принудительно устанавливаем правильную высоту для всех секций
            function setSectionHeights() {
                const sections = document.querySelectorAll('.snap-section');
                const viewportHeight = window.innerHeight;
                
                sections.forEach(section => {
                    section.style.height = viewportHeight + 'px';
                    section.style.minHeight = viewportHeight + 'px';
                });
            }
            
            setSectionHeights();
            window.addEventListener('resize', setSectionHeights);
            
            // Дополнительная поддержка для iOS Safari
            if (/iPad|iPhone|iPod/.test(navigator.userAgent)) {
                setTimeout(setSectionHeights, 100);
                setTimeout(setSectionHeights, 500);
                setTimeout(setSectionHeights, 1000);
            }
        });
        
        // Инициализируем snap скролл при изменении размера окна
        window.addEventListener('resize', function() {
            initMobileSnapScroll();
        });
    </script>
</body>
</html> 